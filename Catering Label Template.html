<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catered Food Labels</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap');

        body {
            margin: 0;
            padding: 0;
            font-family: 'Quicksand', sans-serif;
        }
        .page {
            width: 8.5in;
            height: 11in;
            display: flex;
            flex-wrap: wrap;
            padding: 0.125in; /* Reduced padding to fit labels */
            box-sizing: border-box;
        }
        .label {
            width: 2.75in; /* Reduced width to fit three labels across */
            height: 3.5in; /* Adjusted height for better spacing */
            border: 1.35px solid #000;
            padding: 0.01in; /* Reduced padding */
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        .label .top-section {
            height: 50%;
            border-bottom: 1.35px dashed #000; /* Dashed line for folding */
            display: flex;
            justify-content: center;
            align-items: center;
            /*background-color: #f8f8f8; /* Light gray background */
        }
        .label .bottom-section {
            height: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0.4em; /* Adjusted padding for better spacing */
        }
        .label .dish-name {
            font-size: 1.3em; /* Slightly larger font for better visibility */
            text-align: center;
            margin-bottom: 1.2em;
        }
        .label .dish-name span {
            display: inline-block;
            border-bottom: 2px solid #000;
            width: 80%;
        }
        .label .attributes {
            display: flex;
            justify-content: space-evenly; /* Even spacing for balance */
            margin-bottom: 1.2em;
        }
        .label .recipe {
            text-align: center;
            font-size: 1em; /* Slightly larger font */
            font-style: italic;
            margin-top: 0.5em; /* Added space above Recipe By */
        }
        .label .recipe span {
            display: inline-block;
            border-bottom: 2px solid #000;
            width: 50%;
        }

        .allergen-controls {
            display: flex;
            gap: 1em;
            margin: 1em;
            padding: 1em;
            border: 1px solid #ccc;
            background-color: #f9f9f9;
        }

        @media print {
            .allergen-controls {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="allergen-controls" id="allergen-controls">
        <label><input type="checkbox" value="Dairy Free"> Dairy Free</label>
        <label><input type="checkbox" value="Gluten Free"> Gluten Free</label>
        <label><input type="checkbox" value="Nut Free"> Nut Free</label>
    </div>
    <div class="page" id="page">
        <!-- Label Template -->
        <template id="label-template">
            <div class="label">
                <div class="top-section">
                    <!-- Intentionally blank -->
                </div>
                <div class="bottom-section">
                    <div class="dish-name"><span></span></div>
                    <div class="attributes">
                        <!-- Attributes will be dynamically inserted -->
                    </div>
                    <div class="recipe">Recipe By: <span></span></div>
                </div>
            </div>
        </template>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const page = document.getElementById('page');
            const template = document.getElementById('label-template').content;
            const controls = document.getElementById('allergen-controls');
            const urlParams = new URLSearchParams(window.location.search);
            const allergens = urlParams.get('allergen') ? urlParams.get('allergen').split(',') : [];

            // Populate checkboxes based on URL parameters
            controls.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                if (allergens.includes(checkbox.value)) {
                    checkbox.checked = true;
                }

                checkbox.addEventListener('change', () => {
                    const selectedAllergens = Array.from(controls.querySelectorAll('input[type="checkbox"]:checked'))
                        .map(cb => cb.value);

                    // Update URL with new allergen list
                    const updatedParams = new URLSearchParams(window.location.search);
                    if (selectedAllergens.length > 0) {
                        updatedParams.set('allergen', selectedAllergens.join(','));
                    } else {
                        updatedParams.delete('allergen');
                    }
                    window.location.search = updatedParams.toString();
                });
            });

            // Populate labels with allergens
            for (let i = 0; i < 9; i++) {
                const clone = template.cloneNode(true);
                const attributesContainer = clone.querySelector('.attributes');

                allergens.forEach(allergen => {
                    const allergenSpan = document.createElement('span');
                    allergenSpan.textContent = allergen.trim();
                    attributesContainer.appendChild(allergenSpan);
                });

                page.appendChild(clone);
            }
        });
    </script>
</body>
</html>
